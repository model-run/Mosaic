# ModelRun.io - é¡¹ç›®æ–‡æ¡£

## é¡¹ç›®ç®€ä»‹

ModelRun.io æ˜¯ä¸€ä¸ªæ¨¡å‹è¿è¡Œå‚æ•°ç”Ÿæˆä¸éƒ¨ç½²åŠ©æ‰‹ï¼Œå¸®åŠ©ç”¨æˆ·åœ¨ä¸åŒæ˜¾å¡ã€æ¨ç†å¼•æ“ä¸‹å¿«é€Ÿç”Ÿæˆ Docker å¯åŠ¨å‘½ä»¤ï¼Œå¹¶å±•ç¤ºæ¨¡å‹çš„æœ€å°è¿è¡Œè§„æ ¼ã€CUDA ç‰ˆæœ¬è¦æ±‚åŠæ¨èé…ç½®ã€‚

## æ¶æ„è¯´æ˜

### æŠ€æœ¯æ ˆ
- **å‰ç«¯æ¡†æ¶**: Next.js 14+ (React 18+)
- **æ ·å¼**: Tailwind CSS
- **éƒ¨ç½²**: GitHub Pages
- **è¯­è¨€**: TypeScript
- **é™æ€èµ„æº**: ä½¿ç”¨ `assets` ç›®å½•è€Œéé»˜è®¤çš„ `_next` ç›®å½•

### é¡¹ç›®ç»“æ„
```
Mosaic/
â”œâ”€â”€ allaboutproject.md          # é¡¹ç›®æ–‡æ¡£
â”œâ”€â”€ README.md                   # é¡¹ç›®è¯´æ˜
â”œâ”€â”€ package.json               # ä¾èµ–é…ç½®
â”œâ”€â”€ next.config.js             # Next.js é…ç½®
â”œâ”€â”€ tailwind.config.js         # Tailwind é…ç½®
â”œâ”€â”€ public/                    # é™æ€èµ„æº
â”‚   â”œâ”€â”€ images/               # å›¾ç‰‡èµ„æº
â”‚   â””â”€â”€ favicon.ico           # ç½‘ç«™å›¾æ ‡
â”œâ”€â”€ src/
â”‚   â”œâ”€â”€ app/                  # App Router
â”‚   â”‚   â”œâ”€â”€ page.tsx          # ä¸»é¡µé¢
â”‚   â”‚   â”œâ”€â”€ layout.tsx        # å¸ƒå±€ç»„ä»¶
â”‚   â”‚   â””â”€â”€ globals.css       # å…¨å±€æ ·å¼
â”‚   â”œâ”€â”€ components/           # ç»„ä»¶åº“
â”‚   â”‚   â”œâ”€â”€ GPUSelector.tsx   # GPU é€‰æ‹©å™¨
â”‚   â”‚   â”œâ”€â”€ ModelSelector.tsx # æ¨¡å‹é€‰æ‹©å™¨
â”‚   â”‚   â”œâ”€â”€ EngineSelector.tsx # æ¨ç†å¼•æ“é€‰æ‹©å™¨
â”‚   â”‚   â”œâ”€â”€ ParameterForm.tsx # å‚æ•°é…ç½®è¡¨å•
â”‚   â”‚   â””â”€â”€ CommandGenerator.tsx # å‘½ä»¤ç”Ÿæˆå™¨
â”‚   â”œâ”€â”€ lib/                  # å·¥å…·åº“
â”‚   â”‚   â”œâ”€â”€ gpu-data.ts       # GPU æ•°æ®
â”‚   â”‚   â”œâ”€â”€ model-data.ts     # æ¨¡å‹æ•°æ®
â”‚   â”‚   â””â”€â”€ command-generator.ts # å‘½ä»¤ç”Ÿæˆé€»è¾‘
â”‚   â””â”€â”€ types/                # ç±»å‹å®šä¹‰
â”‚       â””â”€â”€ index.ts          # é€šç”¨ç±»å‹
â””â”€â”€ .github/
    â””â”€â”€ workflows/
        â””â”€â”€ deploy.yml        # GitHub Actions éƒ¨ç½²é…ç½®
```

## ä¸»è¦åŠŸèƒ½

### 1. GPU è¯†åˆ«ä¸æ¨è
- æ”¯æŒä¸»æµ GPU å‹å·ï¼ˆRTX 4090, A100, V100, H100 ç­‰ï¼‰
- è‡ªåŠ¨åŒ¹é…å¯ç”¨çš„æ¨ç†å¼•æ“å’Œå…¼å®¹é…ç½®
- æ˜¾ç¤º GPU è§„æ ¼å’Œæ€§èƒ½å‚æ•°

### 2. æ¨¡å‹æ”¯æŒ
- **å¤§è¯­è¨€æ¨¡å‹**: LLaMA, ChatGLM, Mistral, Qwen ç­‰
- **å›¾åƒç”Ÿæˆ**: Stable Diffusion, DALL-E ç­‰
- **å¤šæ¨¡æ€æ¨¡å‹**: GPT-4V, LLaVA ç­‰

### 3. æ¨ç†å¼•æ“
- **vLLM**: é«˜æ€§èƒ½æ¨ç†å¼•æ“
- **TensorRT-LLM**: NVIDIA ä¼˜åŒ–å¼•æ“
- **Transformers**: Hugging Face æ ‡å‡†åº“
- **Ollama**: æœ¬åœ°éƒ¨ç½²å·¥å…·

### 4. Docker å‘½ä»¤ç”Ÿæˆ
- è‡ªåŠ¨ç”Ÿæˆ GPU åŠ é€Ÿé…ç½®
- å·æŒ‚è½½å’Œç¯å¢ƒå˜é‡è®¾ç½®
- ç«¯å£æ˜ å°„å’Œç½‘ç»œé…ç½®
- èµ„æºé™åˆ¶å’Œä¼˜åŒ–å‚æ•°

## ç»„ä»¶è¯´æ˜

### GPUSelector ç»„ä»¶
```typescript
interface GPUInfo {
  name: string;
  memory: number; // GB
  cudaCapability: string;
  recommendedEngines: string[];
}
```

### ModelSelector ç»„ä»¶
```typescript
interface ModelInfo {
  name: string;
  size: string;
  minMemory: number; // GB
  cudaVersion: string;
  supportedEngines: string[];
}
```

### CommandGenerator ç»„ä»¶
```typescript
interface CommandConfig {
  gpu: GPUInfo;
  model: ModelInfo;
  engine: string;
  parameters: Record<string, any>;
}
```

## ä½¿ç”¨æ–¹å¼

1. **é€‰æ‹© GPU**: ä»ä¸‹æ‹‰åˆ—è¡¨é€‰æ‹©ä½ çš„æ˜¾å¡å‹å·
2. **é€‰æ‹©æ¨¡å‹**: é€‰æ‹©è¦è¿è¡Œçš„æ¨¡å‹
3. **é€‰æ‹©å¼•æ“**: é€‰æ‹©æ¨ç†å¼•æ“
4. **é…ç½®å‚æ•°**: è®¾ç½®æ‰¹å¤„ç†å¤§å°ã€åºåˆ—é•¿åº¦ç­‰å‚æ•°
5. **ç”Ÿæˆå‘½ä»¤**: è‡ªåŠ¨ç”Ÿæˆ Docker å¯åŠ¨å‘½ä»¤
6. **å¤åˆ¶è¿è¡Œ**: ä¸€é”®å¤åˆ¶å‘½ä»¤åˆ°ç»ˆç«¯è¿è¡Œ

## ç¤ºä¾‹è°ƒç”¨

### åŸºæœ¬ä½¿ç”¨
```bash
# é€‰æ‹© RTX 4090 + LLaMA-7B + vLLM
# ç”Ÿæˆå‘½ä»¤:
docker run --gpus all \
  -v /my/models:/models \
  -p 8000:8000 \
  vllm/vllm-openai:latest \
  --model /models/llama-7b \
  --tensor-parallel-size 1 \
  --gpu-memory-utilization 0.8
```

### é«˜çº§é…ç½®
```bash
# å¤š GPU é…ç½®
docker run --gpus all \
  -v /my/models:/models \
  -p 8000:8000 \
  vllm/vllm-openai:latest \
  --model /models/llama-13b \
  --tensor-parallel-size 2 \
  --gpu-memory-utilization 0.9 \
  --max-model-len 4096
```

## å¸¸è§é—®é¢˜

### Q: å¦‚ä½•é€‰æ‹©åˆé€‚çš„æ¨ç†å¼•æ“ï¼Ÿ
A: æ ¹æ®ä½ çš„ GPU å‹å·å’Œæ¨¡å‹å¤§å°é€‰æ‹©ï¼š
- vLLM: é€‚åˆå¤§è¯­è¨€æ¨¡å‹ï¼Œæ€§èƒ½æœ€ä½³
- TensorRT-LLM: NVIDIA GPU ä¼˜åŒ–ï¼Œå…¼å®¹æ€§å¥½
- Transformers: é€šç”¨æ€§å¼ºï¼Œæ˜“äºè°ƒè¯•

### Q: æ˜¾å­˜ä¸è¶³æ€ä¹ˆåŠï¼Ÿ
A: å¯ä»¥å°è¯•ä»¥ä¸‹æ–¹æ³•ï¼š
- ä½¿ç”¨é‡åŒ–æ¨¡å‹ï¼ˆ4bit/8bitï¼‰
- å‡å°‘æ‰¹å¤„ç†å¤§å°
- ä½¿ç”¨æ¨¡å‹å¹¶è¡Œ
- é€‰æ‹©æ›´å°çš„æ¨¡å‹

### Q: å¦‚ä½•ä¼˜åŒ–æ¨ç†æ€§èƒ½ï¼Ÿ
A: å»ºè®®é…ç½®ï¼š
- å¯ç”¨ FP16 ç²¾åº¦
- è°ƒæ•´ GPU å†…å­˜åˆ©ç”¨ç‡
- ä½¿ç”¨åˆé€‚çš„æ‰¹å¤„ç†å¤§å°
- å¯ç”¨ KV ç¼“å­˜

## è°ƒè¯•å»ºè®®

1. **æ£€æŸ¥ GPU é©±åŠ¨**: ç¡®ä¿ CUDA ç‰ˆæœ¬å…¼å®¹
2. **éªŒè¯æ¨¡å‹è·¯å¾„**: ç¡®ä¿æ¨¡å‹æ–‡ä»¶å®Œæ•´
3. **ç›‘æ§èµ„æºä½¿ç”¨**: ä½¿ç”¨ nvidia-smi ç›‘æ§ GPU ä½¿ç”¨ç‡
4. **æŸ¥çœ‹æ—¥å¿—**: æ£€æŸ¥å®¹å™¨æ—¥å¿—æ’æŸ¥é—®é¢˜
5. **æµ‹è¯•è¿æ¥**: éªŒè¯ API æ¥å£æ˜¯å¦æ­£å¸¸å“åº”

## éƒ¨ç½²è¯´æ˜

### æœ¬åœ°å¼€å‘
```bash
# æŸ¥çœ‹æ‰€æœ‰å¯ç”¨å‘½ä»¤
make help

# å¯åŠ¨å¼€å‘æœåŠ¡å™¨
make dev

# æˆ–ç›´æ¥ä½¿ç”¨ pnpm å‘½ä»¤
pnpm install
pnpm run dev
```

### æ„å»ºéƒ¨ç½²
```bash
# ä½¿ç”¨ Makefile å®Œæ•´éƒ¨ç½²æµç¨‹
make deploy-full

# æˆ–åˆ†æ­¥æ‰§è¡Œ
make export          # æ„å»ºå¹¶å¯¼å‡ºåˆ°æ ¹ç›®å½•
make commit-build    # æäº¤æ„å»ºäº§ç‰©åˆ° Git
```

### GitHub Pages éƒ¨ç½²
é¡¹ç›®å·²é…ç½®ç¬¦åˆ GitHub Pages è§„èŒƒçš„ç»“æ„ï¼š

#### ç›®å½•ç»“æ„
```
Mosaic/
â”œâ”€â”€ docs/                      # GitHub Pages æ„å»ºäº§ç‰©ç›®å½•
â”‚   â”œâ”€â”€ assets/                # é™æ€èµ„æº
â”‚   â”‚   â”œâ”€â”€ css/
â”‚   â”‚   â”‚   â””â”€â”€ style.css      # ç¼–è¯‘åçš„ CSS æ–‡ä»¶
â”‚   â”‚   â””â”€â”€ js/
â”‚   â”‚       â””â”€â”€ site.js        # ç«™ç‚¹ JavaScript
â”‚   â”œâ”€â”€ index.html             # ä¸»é¡µé¢
â”‚   â””â”€â”€ ...                    # å…¶ä»–æ„å»ºäº§ç‰©
â”œâ”€â”€ web/                       # Next.js å¼€å‘ç¯å¢ƒ
â”œâ”€â”€ _config.yml               # Jekyll é…ç½®æ–‡ä»¶
â””â”€â”€ .github/workflows/
    â””â”€â”€ deploy.yml            # GitHub Actions éƒ¨ç½²é…ç½®
```

#### éƒ¨ç½²æ–¹å¼
1. **è‡ªåŠ¨éƒ¨ç½²**: æ¨é€åˆ° main åˆ†æ”¯è‡ªåŠ¨è§¦å‘ GitHub Actions
2. **æ‰‹åŠ¨éƒ¨ç½²**: ä½¿ç”¨ `make deploy-github-pages` å‘½ä»¤
3. **è®¿é—®åœ°å€**: `https://your-username.github.io/Mosaic`

#### GitHub Pages é…ç½®
- **å‘å¸ƒæº**: é€‰æ‹© `docs/` ç›®å½•ä½œä¸ºå‘å¸ƒæº
- **åˆ†æ”¯**: ä½¿ç”¨ `main` åˆ†æ”¯
- **æ„å»ºäº§ç‰©**: è‡ªåŠ¨ç”Ÿæˆåˆ° `docs/` ç›®å½•

#### é™æ€èµ„æºé…ç½®
- **é™æ€èµ„æºç›®å½•**: ä½¿ç”¨ `assets` ç›®å½•è€Œéé»˜è®¤çš„ `_next` ç›®å½•
- **CSS æ–‡ä»¶**: æ”¾åœ¨ `docs/assets/static/css/` ç›®å½•ä¸‹
- **JS æ–‡ä»¶**: æ”¾åœ¨ `docs/assets/static/chunks/` ç›®å½•ä¸‹
- **HTML å¼•ç”¨**: è·¯å¾„ä¸º `./assets/static/css/` å’Œ `./assets/static/chunks/`
- **æ„å»ºå¤„ç†**: Makefile è‡ªåŠ¨å°† `_next` ç›®å½•é‡å‘½åä¸º `assets` å¹¶æ›´æ–° HTML ä¸­çš„è·¯å¾„å¼•ç”¨

### é¡¹ç›®çŠ¶æ€
âœ… å·²å®Œæˆçš„åŠŸèƒ½ï¼š
- Next.js 14 é¡¹ç›®ç»“æ„åˆå§‹åŒ–
- TypeScript ç±»å‹å®šä¹‰
- å“åº”å¼ UI ç»„ä»¶
- GPU/æ¨¡å‹/å¼•æ“é€‰æ‹©å™¨
- å‚æ•°é…ç½®è¡¨å•
- Docker å‘½ä»¤ç”Ÿæˆå™¨
- GitHub Actions è‡ªåŠ¨éƒ¨ç½²
- å®Œæ•´çš„é¡¹ç›®æ–‡æ¡£
- pnpm åŒ…ç®¡ç†å™¨é…ç½®

ğŸš€ é¡¹ç›®å·²å‡†å¤‡å°±ç»ªï¼Œå¯ä»¥å¼€å§‹å¼€å‘å’Œä½¿ç”¨ï¼

### åŒ…ç®¡ç†å™¨è¯´æ˜
é¡¹ç›®å·²ä» npm è¿ç§»åˆ° pnpmï¼Œå…·æœ‰ä»¥ä¸‹ä¼˜åŠ¿ï¼š
- æ›´å¿«çš„å®‰è£…é€Ÿåº¦
- æ›´å°‘çš„ç£ç›˜ç©ºé—´å ç”¨
- æ›´ä¸¥æ ¼çš„ä¾èµ–ç®¡ç†
- æ›´å¥½çš„ monorepo æ”¯æŒ

### Makefile è¯´æ˜
é¡¹ç›®ä½¿ç”¨ Makefile æä¾›æ ‡å‡†åŒ–çš„å¼€å‘å‘½ä»¤ï¼š
- `make help`: æŸ¥çœ‹æ‰€æœ‰å¯ç”¨å‘½ä»¤
- `make dev`: å¯åŠ¨å¼€å‘æœåŠ¡å™¨
- `make build`: æ„å»ºç”Ÿäº§ç‰ˆæœ¬
- `make deploy`: å‡†å¤‡éƒ¨ç½²æ–‡ä»¶
- `make clean`: æ¸…ç†ç¼“å­˜
- `make check`: è¿è¡Œå®Œæ•´æ£€æŸ¥
